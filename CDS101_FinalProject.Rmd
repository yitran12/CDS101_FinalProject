---
title: "CDS-101 Checkpoint #2"
author: 
  - Eunho Cha, Daeun Choi, Songlee Jun, Hyun Woo Kang
  - Dawon Kyoung, Byungwook Oh, Duy Tran
date: "`r Sys.Date()`"
documentclass: article
geometry: margin=1in
fontsize: 11pt
output:
  pdf_document:
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    dev: pdf
    highlight: tango
  html_document:
    theme: default
    self_contained: true
    toc: false
    df_print: kable
    fig_caption: false
    number_sections: false
    smart: true
    dev: svg
---

```{r setup, include = FALSE}
# DO NOT ALTER THIS CHUNK
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  fig.width = 5,
  fig.asp = 0.618,
  out.width = "70%",
  dpi = 120,
  fig.align = "center",
  cache = FALSE
)
is_pdf <- try (("pdf_document" %in% rmarkdown::all_output_formats(knitr::current_input())), silent=TRUE)
is_pdf <- (is_pdf == TRUE)
# Load required packages
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(broom))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(modelr))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(infer))
# Load dataset
Group_dataset <- read_xlsx("Group_dataset.xlsx")

```


#GHG = Greenhouse Gases
#FJO = Female Job Occupation


# Organizing Dataset (Hyunwoo Kang)
```{r}
colnames(Group_dataset)<- c("Year", "Birth_GR", "GHG_GR", "Inflation_GR", "FJO_GR")

view(Group_dataset)
```


# Summarize
```{r}
summary(Group_dataset)
```


# Select
```{r}
Envo_ft <- Group_dataset %>%
 select(Year, Birth_GR, GHG_GR)
```

```{r}
Econ_ft <- Group_dataset %>%
  select(Year, Birth_GR, Inflation_GR)
```

```{r}
Soci_ft <- Group_dataset %>%
   select(Year, Birth_GR, FJO_GR)
```


# Variation of Birth Growth rate by Year (Hyunwoo Kang)

```{r}
 Group_dataset %>%
  ggplot() +
  geom_point(mapping = aes(y = Birth_GR, x= Year))+ 
  geom_smooth(mapping = (aes(y = Birth_GR, x = Year)), method ='lm') +
  labs(title = "Scatterplot of Birth growth rate by Year", 
       y = "Birth Rate", 
       x = "Year")
```


# Variation and Covariation - Envo_ft (Songlee Jun)

```{r}
Envo_ft %>%
 ggplot() +
 geom_point(mapping = aes(x = Year, y = GHG_GR)) +
 geom_smooth(mapping = aes(x = Year, y = GHG_GR), method = "lm") + 
  labs(title = "Scatterplot of Greenhouse Gas Emission Growth rate 
       by Year",
       x = "Year",
       y = "Greenhouse gas emission")
```


```{r}
Envo_ft %>%
   ggplot()+
   geom_point(mapping = aes(x  = GHG_GR, y = Birth_GR)) +
   geom_smooth(mapping = aes(x  = GHG_GR, y  = Birth_GR), method="lm")+
  labs(
    title = "Scatterplot of Greenhouse gas emission vs Birth rate",
    x = 'Greenhouse gas emission',
    y = "Birth rate")
```

```{r}
Group_dataset %>%
  ggplot() +
  geom_point(mapping = aes(x = GHG_GR, y = Inflation_GR))+
  geom_smooth(mapping=aes(x = GHG_GR, y = Inflation_GR), method="lm")+
  labs(
    title = "Scatterplot of Greenhouse Gas Emission
vs Inflation Rate",
    x = "Greenhouse gas emission",
    y = "Inflation rate") 
```

```{r}
Group_dataset%>%
  ggplot() +
  geom_point(mapping = aes(x = GHG_GR, y = FJO_GR)) +
geom_smooth(mapping=aes(x = GHG_GR, y = FJO_GR), method="lm")+
  labs(
    title = "Scatterplot of Greenhouse Gas Emission vs Female
Job Occupation",
    x = "Greenhouse gas emission",
    y = "Female Job Occupation") 
```


# Modeling & Hyphothesis test- Envo_ft (Byungwook Oh)

```{r}
# Model
Envo_ft_model <- lm(Birth_GR ~ GHG_GR, data = Envo_ft)
```

```{r}
# Tidy model
Envo_ft_model %>%
  tidy()
```

```{r}
# Null distribution
Envo_null_distribution <- Envo_ft %>%
  specify(Birth_GR ~ GHG_GR) %>%
  hypothesize(null="independence") %>%
  generate(reps=10000, type="permute") %>%
  calculate(stat="slope")
```

```{r}
# Observed stat
Observed_stat <- Envo_ft %>%
  specify(Birth_GR ~ GHG_GR) %>%
  calculate(stat="slope")
```

```{r}
# P-value
Envo_null_distribution %>%
  get_p_value(obs_stat=Observed_stat, direction="both")
```

```{r}
# P-value visualization
Envo_null_distribution %>%
  visualize() +
  shade_p_value(obs_stat=Observed_stat, direction= "both") +
  labs(title = "P-value Visualization for Environmental Null Hypothesis")
```


# Variation and Covariation - Econ_ft (Dawon Kyoung)

```{r}
 Econ_ft %>%
  ggplot() +
  geom_point(mapping = aes(y = Inflation_GR, x= Year))+ 
  geom_smooth(mapping = (aes(y = Inflation_GR, x = Year)), method ='lm') +
  labs(title = "Scatterplot of Inflation growth rate by Year", 
       y = "Inflation Rate", 
       x = "Year")
```


```{r}
Econ_ft %>%
  ggplot() +
  geom_point(mapping=aes(x = Inflation_GR, y = Birth_GR))+
  geom_smooth(mapping=aes(x = Inflation_GR, y = Birth_GR), method='lm')+
  labs(
    title= 'Scatterplot of Inflation rate vs Birth rate',
    x= 'Inflation rate',
    y= "Birth rate")
```

```{r}
Group_dataset %>%
   ggplot() +
   geom_point(mapping= aes( x =Inflation_GR, y = GHG_GR))+
   geom_smooth(mapping=aes(x = Inflation_GR, y = GHG_GR),
method= 'lm')+
   labs(
     title= 'Scatterplot of inflation rate vs Greenhouse Gas
Emission',
     x= 'Inflation rate',
     y= 'Greenhouse Gas Emission')
```

```{r}
Group_dataset %>%
   ggplot() +
   geom_point(mapping = aes(x= Inflation_GR, y= FJO_GR))+
   geom_smooth(mapping=aes(x= Inflation_GR, y= FJO_GR),
method= 'lm')+
   labs(
     title= 'Scatterplot of Inflation rate vs Female Job Occupation',
     x= 'Inflation rate',
     y= 'Female Job Occupation')
```


# Modeling & Hyphothesis test- Econ_ft (Daeun Choi)

```{r}
# Model
Econ_ft_model <- lm(Birth_GR ~ Inflation_GR, data=Econ_ft)
```

```{r}
# Tidy model
Econ_ft_model %>%
  tidy()
```

```{r}
# Null distribution
Econ_null_distribution <- Econ_ft %>%
  specify(Birth_GR ~ Inflation_GR) %>%
  hypothesize(null="independence") %>%
  generate(reps=10000, type="permute") %>%
  calculate(stat="slope")
```

```{r}
# Observed stat
Observed_stat <- Econ_ft %>%
  specify(Birth_GR ~ Inflation_GR) %>%
  calculate(stat="slope")
```

```{r}
# P-value
Econ_null_distribution %>%
  get_p_value(obs_stat=Observed_stat, direction="both")
```

```{r}
# P-value visualization
Econ_null_distribution %>%
  visualize() +
  shade_p_value(obs_stat=Observed_stat, direction= "both") +
  labs(title = "P-value Visualization for Economical Null Hypothesis")
```


# Variation and Covariation - Soci_ft (Eunho Cha)

```{r}  
Soci_ft %>%
  ggplot() +
  geom_point(mapping = aes(y = FJO_GR, x = Year)) +
  geom_smooth(mapping = aes(y = FJO_GR, x = Year), method = 'lm') +
  labs(title = "Scatterplot of Female Job Occupation Growth rate
by Year",
       y  = "Female Job Occupation",
       x = "Year")
```

```{r}
Soci_ft %>%
   ggplot() +
   geom_point(mapping = aes(x= FJO_GR, y= Birth_GR))+
   geom_smooth(mapping=aes(x = FJO_GR, y = Birth_GR), method="lm")+
   labs(
     title="Scatterplot of Female Job Occupation vs Birth Rate",
     x= "Female Job Occupation",
     y= "Birth Rate"
   )
```

```{r}
Group_dataset %>%
   ggplot() +
   geom_point(mapping= aes (x= FJO_GR, y= GHG_GR)) +
   geom_smooth(mapping=aes (x= FJO_GR, y=GHG_GR), method="lm")+
   labs(
     title= "Scatterplot of Female Job Occupation vs Greenhouse
Gas Emission",
     x= "Female Job Occupation",
     y= "Greenhouse Gas Emission"
   )
```

```{r}
Group_dataset %>%
   ggplot() +
   geom_point(mapping= aes (x= FJO_GR, y=Inflation_GR)) +
   geom_smooth(mapping=aes (x= FJO_GR, y=Inflation_GR), method="lm")+
   labs(
     title= "Scatterplot of Female Job Occupation vs Inflation Rate",
     x= "Female Job Occupation",
     y= "Inflation Rate"
   )
```   


# Modeling & Hypothesis test - Soci_ft (Duy Tran)

```{r}
# Model
Soci_ft_model <- lm(Birth_GR ~ FJO_GR, data = Soci_ft)
```

```{r}
# Tidy model
Soci_ft_model %>%
  tidy()
```

```{r}
# Null distribution
Soci_null_distribution <- Soci_ft %>%
  specify(Birth_GR ~ FJO_GR) %>%
  hypothesize(null="independence") %>%
  generate(reps=10000, type="permute") %>%
  calculate(stat="slope")
```

```{r}
# Observed stat
Observed_stat <- Soci_ft %>%
  specify(Birth_GR ~ FJO_GR) %>%
  calculate(stat="slope")
```

```{r}
# P-value
Soci_null_distribution %>%
  get_p_value(obs_stat=Observed_stat, direction="both")
```

```{r}
# P-value visualization
Soci_null_distribution %>%
  visualize() +
  shade_p_value(obs_stat=Observed_stat, direction="both") +
  labs(title ="P-value visualization for Sociological Null Hypothesis")
```